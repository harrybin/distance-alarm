<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:DistanceAlarm.ViewModels"
             x:Class="DistanceAlarm.Views.SettingsPage"
             x:DataType="viewmodels:SettingsViewModel"
             Title="Settings">

    <ScrollView>
        <VerticalStackLayout Spacing="16" Padding="16">

            <!-- Ping Settings -->
            <Frame Style="{StaticResource MaterialCardStyle}">
                <VerticalStackLayout Spacing="20">
                    <Label Text="Connection Settings" 
                           Style="{StaticResource TitleLarge}" />
                    
                    <VerticalStackLayout Spacing="8">
                        <Label Text="Ping Interval (seconds)" 
                               Style="{StaticResource LabelLarge}" />
                        <HorizontalStackLayout Spacing="16" HorizontalOptions="Center">
                            <Stepper Value="{Binding Settings.PingInterval}" 
                                     Minimum="1" 
                                     Maximum="60" 
                                     Increment="1" />
                            <Label Text="{Binding Settings.PingInterval}" 
                                   VerticalOptions="Center" 
                                   Style="{StaticResource TitleMedium}" />
                        </HorizontalStackLayout>
                    </VerticalStackLayout>
                </VerticalStackLayout>
            </Frame>

            <!-- Alarm Settings -->
            <Frame Style="{StaticResource MaterialCardStyle}">
                <VerticalStackLayout Spacing="20">
                    <Label Text="Alarm Settings" 
                           Style="{StaticResource TitleLarge}" />
                    
                    <!-- Vibration Settings -->
                    <VerticalStackLayout Spacing="12">
                        <HorizontalStackLayout Spacing="16">
                            <Switch IsToggled="{Binding Settings.VibrationEnabled}" />
                            <Label Text="Enable Vibration" 
                                   VerticalOptions="Center" 
                                   Style="{StaticResource TitleMedium}" />
                        </HorizontalStackLayout>
                        
                        <VerticalStackLayout Spacing="8" 
                                           IsEnabled="{Binding Settings.VibrationEnabled}"
                                           Margin="32,0,0,0">
                            <Label Text="Vibration Duration (ms)" 
                                   Style="{StaticResource LabelLarge}" />
                            <HorizontalStackLayout Spacing="16" HorizontalOptions="Center">
                                <Stepper Value="{Binding Settings.VibrationDuration}" 
                                         Minimum="100" 
                                         Maximum="5000" 
                                         Increment="100" />
                                <Label Text="{Binding Settings.VibrationDuration}" 
                                       VerticalOptions="Center" 
                                       Style="{StaticResource BodyLarge}" />
                            </HorizontalStackLayout>
                        </VerticalStackLayout>
                    </VerticalStackLayout>

                    <!-- Sound Settings -->
                    <VerticalStackLayout Spacing="12">
                        <HorizontalStackLayout Spacing="16">
                            <Switch IsToggled="{Binding Settings.SoundEnabled}" />
                            <Label Text="Enable Sound" 
                                   VerticalOptions="Center" 
                                   Style="{StaticResource TitleMedium}" />
                        </HorizontalStackLayout>
                        
                        <VerticalStackLayout Spacing="8" 
                                           IsEnabled="{Binding Settings.SoundEnabled}"
                                           Margin="32,0,0,0">
                            <Label Text="Sound Volume" 
                                   Style="{StaticResource LabelLarge}" />
                            <HorizontalStackLayout Spacing="16">
                                <Slider Value="{Binding Settings.SoundVolume}" 
                                        Minimum="0" 
                                        Maximum="1"
                                        HorizontalOptions="FillAndExpand" />
                                <Label Text="{Binding Settings.SoundVolume, StringFormat='{0:P0}'}" 
                                       VerticalOptions="Center" 
                                       Style="{StaticResource BodyLarge}"
                                       WidthRequest="50" />
                            </HorizontalStackLayout>
                        </VerticalStackLayout>
                    </VerticalStackLayout>

                    <!-- Notification Settings -->
                    <HorizontalStackLayout Spacing="16">
                        <Switch IsToggled="{Binding Settings.NotificationEnabled}" />
                        <Label Text="Enable Notifications" 
                               VerticalOptions="Center" 
                               Style="{StaticResource TitleMedium}" />
                    </HorizontalStackLayout>
                </VerticalStackLayout>
            </Frame>

            <!-- Action Buttons -->
            <VerticalStackLayout Spacing="12">
                <Button Text="Save Settings" 
                        Command="{Binding SaveSettingsCommand}" />
                
                <Button Text="Reset to Defaults" 
                        Command="{Binding ResetToDefaultsCommand}"
                        Style="{StaticResource OutlinedButtonStyle}" />
            </VerticalStackLayout>

        </VerticalStackLayout>
    </ScrollView>

</ContentPage>